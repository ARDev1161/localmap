1) попробовать реализовать через flat_map
2) реализовать математику через косинус одного угла с коэффициентами
3) реализовать логирование (ошибки, запуск, создание слоёв)
